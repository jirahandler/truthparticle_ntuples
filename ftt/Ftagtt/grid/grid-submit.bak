#!/usr/bin/env bash

if [[ $- == *i* ]] ; then
    echo "Don't source me!" >&2
    return 1
else
    set -eu
fi

ZIPFILE=job.tar
if [[ -f $ZIPFILE ]] ; then
    rm $ZIPFILE
fi

SCRIPT_DIR=$(dirname $BASH_SOURCE)

#choose the joboptions file you want to use
JO=main

DSS=(
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
)
for DS in ${DSS[*]}; do
    a1=`cut -c 23-28 <<< $DS`
    a2=`cut -c 54-58 <<< $DS`
    a3=`cut -c 69- <<< $DS`
    a4=$(sed 's/.\{42\}$//' <<< "$a3")
    a=$a1$a2$a4
    OUTDS="user.$USER.$a$(date +'%Y%-m%d').root"
	echo $OUTDS
    ${SCRIPT_DIR}/ftag-grid-sub.sh -j $JO -d $DS -l $OUTDS  -z job.tar    
done
